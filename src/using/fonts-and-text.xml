<?xml version='1.0' encoding="UTF-8" ?>

<sect2 id='gimp-text' xmlns:xi="http://www.w3.org/2001/XInclude" lang="en;zh_CN">
  <title lang="en">Text and Fonts</title>
  <title lang="zh_CN">文字和字体</title>

  <indexterm>
    <primary lang="en">Image</primary>
    <secondary lang="en">Text</secondary>
  </indexterm>
  <indexterm>
    <primary lang="zh_CN">图像</primary>
    <secondary lang="zh_CN">文字</secondary>
  </indexterm>

  <informalfigure>
    <mediaobject>
      <imageobject>
        <imagedata
          fileref='../images/using/text-example.png'
          format="PNG"/>
      </imageobject>

      <caption>
	<para lang='en'>
	  Example of a text item, showing the boundary of the text
	  layer.  (Font: Utopia Bold)
	</para>
	<para lang="zh_CN">
	  一个文本例子，显示文字图层的边缘。(字体：Utopia Bold)
	</para>
      </caption>
    </mediaobject>
  </informalfigure>

  <para lang='en'>
    One of the greatest improvements of GIMP 2.0 over GIMP 1.2 is in
    the handling of text.  In GIMP 2.0 and 2.2, each text item goes in a
    separate Text layer, and you can come back later to the layer and
    edit the text in it.  You can also move the text around in the
    image, or change the font, or the font size.  You can use any
    font available on your system.  You can control justification,
    indentation, and line spacing.  
  </para>
  <para lang="zh_CN">
    从 GIMP 1.2 到 GIMP 2.0，一个最大的进步就在处理文字。GIMP 2.0 和 2.2 中，每个文本都有自己独立的文字图层，以后可以通过该图层来编辑其中的文字，还可以在图像中移动文字，改变字体及其大小。您可以使用系统中可用的任何字体，控制其对齐，缩进和行距。
  </para>

  <para lang='en'>
    Actually, you can operate on a text layer in the same ways as any
    other layer, but doing so often means giving up the ability to
    edit the text without losing the results of your work.
  </para>
  <para lang="zh_CN">
    实际上，您能像其它图层一样操作文字图层，不过这样做通常意谓着放弃编辑文字的能力而不会丢失您所工作的结果。
  </para>

  <para lang='en'>
    To understand some of the idiosyncracies of text handling, it may
    help for you to realize that a text layer contains more
    information than the pixel data that you see:  it also contains a
    representation of the text in a text-editor format.  You can see
    this in the text-editor window that pops up while you are using the
    Text tool.  Every time you alter the text, the image layer is
    redrawn to reflect your changes. 
  </para>
  <para lang="zh_CN">
    要理解文字处理的一些特性，先要认识到一个文字图层比您所看到的像素数据要包含更多的信息：它还包括表现为文本编辑器格式的文字，在使用文字工具弹出的文本编辑器窗口中可以看到。每当您修改文本时，图像图层都重画并反映出这些变化。
  </para>

  <para lang='en'>
    Now suppose you create a text layer, and then operate on it in
    some way that does not involve the Text tool:  rotate it, for
    example.  Suppose you then come back and try to edit it using the
    Text tool.  As soon as you edit the text, the Text tool will
    redraw the layer, wiping out the results of the operations you
    performed in the meantime.
  </para>
  <para lang="zh_CN">
    现在假设新建一个文字图层，然后用文字工具外的操作对它进行处理：比如旋转它。然后打算再用文字工具编辑它。一旦您编辑了文本，文字工具就会重画图层，清除此间所作的所有操作。
  </para>

  <para lang='en'>
    Because this danger is not obvious, the Text tool tries to protect
    you from it.  If you operate on a text layer, and then later try
    to edit the text, a message pops up, warning you that your
    alterations will be undone, and giving you three options:  (1)
    edit the text anyway; (2) cancel; (3) create a new text layer with
    the same text as the existing layer, leaving the existing layer
    unchanged. 
  </para>
  <para lang="zh_CN">
    由于这种危险不明显，文字工具避免您这样做。对文字图层操作后再尝试编辑它时，会弹出一条警告信息，告诉您所作的修改会被恢复原状，并给您三个选项：(1)强行编辑;(2)取消;(3)新建一个与现有图层有相同文本的文字图层，而保持现有图层不变。
  </para>

  <simplesect>
    <title lang='en'>Embellishing Text</title>
    <title lang="zh_CN">装饰文字</title>

    <informalfigure>
      <mediaobject>
        <imageobject>
          <imagedata
            fileref='../images/using/logo-examples.png'
            format="PNG"/>
         </imageobject>

	 <caption>
	   <para lang='en'>
	     Four fancy text items created using logo scripts:  "alien
	     neon", "bovination", "frosty", and "chalk".  Default
	     settings were used for everything except font size.
	  </para>
      <para lang="zh_CN">
        四个用徽标脚本创建的特效文字：“奇异霓虹灯”，“奶牛”，“霜冻”和“粉笔”除了文字大小都是使用的默认设置。
      </para>
	</caption>
      </mediaobject>
    </informalfigure>

    <para lang='en'>
      There are many things you can do to vary the appearance of text
      beyond just rendering it with different fonts or different
      colors.  By converting a text item to a selection or a path, you
      can fill it, stroke the outlines, transform it, or generallly
      apply the whole panoply of GIMP tools to get interesting
      effects.  As a demonstration of some of the possibilities, try
      out the "logo" scripts in the Toolbox menu, at
      <menuchoice>
        <guimenu>Xtns</guimenu>
        <guisubmenu>Script-Fu</guisubmenu>
        <guisubmenu>Logos</guisubmenu>
      </menuchoice>.
      Each of these scripts allows you to enter some text, and then
      creates a new image showing a logo constructed out of that text.
        If you would like to modify one of these scripts, or construct
        a logo script of your own, the <link
        linkend='gimp-using-script-fu'>Using Script-Fu</link> and  <link
        linkend='gimp-using-script-fu-tutorial'>Script-Fu
        Tutorial</link> sections should help you get started.  Of
        course, you don't need Script-Fu to create these sorts of
        effects, only to automate them.
    </para>
    <para lang="zh_CN">
      除了用不同的字体和大小绘制文本之外还有很多其它改变其外观的方式。通过将文字转换为选区或路径，您可以填充它，勾画外轮廓，变换它，或运用几乎全部 GIMP 工具增强其效果。比如“徽标”脚本就是其中一种选择，它在工具箱菜单
    <menuchoice>
        <guimenu>扩展</guimenu>
        <guisubmenu>Script-Fu</guisubmenu>
        <guisubmenu>徽标</guisubmenu>
      </menuchoice>。可以在这些脚本中输入一些文字，然后它们会创建一个基于这些文字的徽标的新图像。假如您想修改这些脚本，或创建自己的徽标脚本，<link linkend='gimp-using-script-fu'>使用 Script-Fu</link>和<link linkend='gimp-using-script-fu-tutorial'>Script-Fu 指导</link>是很好的指导。当然不必用 Script-Fu 来产生这些效果，而是让它们自动生成。
    </para>
  </simplesect>

  <simplesect id='gimp-fonts'>
    <title lang='en'>Adding Fonts</title>
    <title lang="zh_CN">添加字体</title>

    <para lang='en'>
      For the most authoritative and up-to-date information on fonts
      in GIMP, consult the <ulink
      url='http://gimp.org/unix/fonts.html'>Fonts in GIMP 2.0</ulink>
      page at the GIMP web site.  This section attempts to give you a
      helpful overview.
    </para>
    <para lang="zh_CN">
      关于 GIMP 字体最权威和最新的信息请看 GIMP 网站上的 <ulink url='http://gimp.org/unix/fonts.html'>Fonts in GIMP 2.0</ulink> 页。这里只是给您一个概述。
    </para>

    <para lang='en'>
      GIMP uses the FreeType 2 font engine to render fonts, and a
      system called Fontconfig to manage them.  GIMP will let you use
      any font in Fontconfig's font path; it will also let you use any
      font it finds in GIMP's font search path, which is set on the
      <link linkend='gimp-prefs-folders-data'>Font Folders</link> page
      of the Preferences dialog.  By default, the font search path
      includes a system GIMP-fonts folder (which you should not alter,
      even though it is actually empty), and a
      <filename>fonts</filename> folder inside your personal GIMP
      directory.  You can add new folders to the font search path if
      it is more convenient for you.
    </para>
    <para lang="zh_CN">
      GIMP 使用 FreeType 2 字体引擎渲染字体，而用一个叫作 Fontconfig 的系统管理它们。GIMP 让您使用 Fontconfig 字体路径中和 GIMP 字体搜索路径中的任何字体，后者可以在首选项对话框的<link linkend='gimp-prefs-folders-data'>字体文件夹</link>页设置。默认情况下，字体搜索路径包括系统 GIMP 字体文件夹(即使是空的也无法更改)，和个人 GIMP 目录的 <filename>fonts</filename> 文件夹。如果觉的更方便也可以在字体搜索路径中添加新的文件夹。
    </para>

    <para lang='en'>
      FreeType 2 is a very powerful and flexible system.  By default,
      it supports the following font file formats:
    </para>
    <para lang="zh_CN">
      FreeType 2 是非常强大和灵活的系统，它默认支持下面的字体文件格式：
    </para>

    <itemizedlist lang='en'>
      <listitem>
        <para>
          TrueType fonts (and collections)
        </para>
      </listitem>
      <listitem>
        <para>
          Type 1 fonts
        </para>
      </listitem>
      <listitem>
        <para>
          CID-keyed Type 1 fonts
        </para>
      </listitem>
      <listitem>
        <para>
          CFF fonts
        </para>
      </listitem>
      <listitem>
        <para>
          OpenType fonts (both TrueType and CFF variants)
        </para>
      </listitem>
      <listitem>
        <para>
          SFNT-based bitmap fonts
        </para>
      </listitem>
      <listitem>
        <para>
          X11 PCF fonts
        </para>
      </listitem>
      <listitem>
        <para>
          Windows FNT fonts
        </para>
      </listitem>
      <listitem>
        <para>
          BDF fonts (including anti-aliased ones)
        </para>
      </listitem>
      <listitem>
        <para>
          PFR fonts
        </para>
      </listitem>
      <listitem>
        <para>
          Type42 fonts (limited support)
        </para>
      </listitem>
    </itemizedlist>

    <itemizedlist lang="zh_CN">
      <listitem>
        <para>
          TrueType 字体 (及其集合)
        </para>
      </listitem>
      <listitem>
        <para>
          Type 1 字体
        </para>
      </listitem>
      <listitem>
        <para>
          CID-keyed Type 1 字体
        </para>
      </listitem>
      <listitem>
        <para>
          CFF fonts
        </para>
      </listitem>
      <listitem>
        <para>
          OpenType 字体 (TrueType 和 CFF 变体)
        </para>
      </listitem>
      <listitem>
        <para>
          SFNT-based 位图字体
        </para>
      </listitem>
      <listitem>
        <para>
          X11 PCF 字体
        </para>
      </listitem>
      <listitem>
        <para>
          Windows FNT 字体
        </para>
      </listitem>
      <listitem>
        <para>
          BDF 字体 (包括抗锯齿)
        </para>
      </listitem>
      <listitem>
        <para>
          PFR 字体
        </para>
      </listitem>
      <listitem>
        <para>
          Type42 字体 (支持有限)
        </para>
      </listitem>
    </itemizedlist>


    <para lang='en'>
      You can also add modules to support other types of font files.
      See <ulink
      url='http://www.freetype.org/freetype2/index.html#features'>FREETYPE
      2</ulink> for more information.
    </para>
    <para lang="zh_CN">
      也可以通过添加模块来支持其它类型的字体文件，请看<ulink url='http://www.freetype.org/freetype2/index.html#features'>FREETYPE 2</ulink>。
    </para>

    <formalpara lang='en'>
      <title>Linux</title>

      <para>
	On a Linux system, if the Fontconfig utility is set up as usual,
	all you need to do to add a new font is to place the file in the
	directory <filename>~/.fonts</filename>.  This will make the font
	available not only to GIMP, but to any other program that uses
	Fontconfig.  If for some reason you want the font to be available
	to GIMP only, you can place it in the <filename>fonts</filename>
	subdirectory of your personal GIMP directory, or some other
	location in your font search path.  Doing either will cause the
	font to show up the next time you start GIMP.  If you want to use
	it in an already running GIMP, press the
	<emphasis>Refresh</emphasis> button in the <link
	linkend='gimp-font-dialog'>Fonts dialog</link>.
      </para>
    </formalpara>

    <formalpara lang="zh_CN">
      <title>Linux</title>
      <para>
        Linux 系统中，如果 Fontconfig 工具是按默认的设置，就可以通过添加新字体文件到<filename>~/.fonts</filename>目录来增加新字体。这样不光是 GIMP 能用这些字体，其它使用 Fontconfig 的程序也可以。如果您只想 GIMP 使用这些字体，可以把它们放到个人 GIMP 目录的 <filename>fonts</filename> 子目录或字体搜索路径中其它位置，这样在下次启动 GIMP 时，这些字体就能显示。当要在已经运行的 GIMP 中使用它们，可以按<link linkend='gimp-font-dialog'>字体对话框</link>的<emphasis>刷新</emphasis>按钮。
      </para>
    </formalpara>

    <formalpara lang='en'>
      <title>Windows</title>

      <para>
	The easiest way to install a font is to drag the file onto the
	Fonts directory and let the shell do its magic.  Unless you've done
	something creative, it's probably in its default location of
	<filename>C:\windows\fonts</filename> or
	<filename>C:\winnt\fonts</filename>.  Sometimes double-clicking on
	a font will install it as well as display it; sometimes it only
	displays it.  This method will make the font available not only to
	GIMP, but also to other Windows applications.
      </para>
    </formalpara>

    <formalpara lang="zh_CN">
      <title>Windows</title>
      <para>
        安装字体的最简单方法是拖动文件到字体目录中。除非您搞了些有创意的东西，不然其默认位置一般是在 <filename>C:\windows\fonts</filename> 或 <filename>C:\winnt\fonts</filename>。有时双击字体也会安装并显示它;有时却只显示。这种方法不光是字体在 GIMP 中可用，而且其它 Windows 程序也可用。
      </para>
    </formalpara>

    <para lang='en'>
      To install a Type 1 file, you need both the
      <filename>.pfb</filename> and <filename>.pfm</filename>
      files. Drag the one that gets an icon into the fonts folder.
      The other one doesn't strictly need to be in the same directory
      when you drag the file, since it uses some kind of search
      algorithm to find it if it's not, but in any case putting it in
      the same directory does no harm. 
    </para>
    <para lang="zh_CN">
      安装 Type 1 文件，您需要 <filename>.pfb</filename> 和 <filename>.pfm</filename> 文件。拖动其中一个到字体文件夹中都会出现一个图标，另一个没要求一定要在同一个目录中，因为它们不管在不在一个目录中都使用相同的搜索算法，不过将它们放在一起也没有坏处。
    </para>

    <para lang='en'>
      In principle, GIMP can use any type of font on Windows that 
      FreeType can handle; however, for fonts that Windows can't
      handle natively, you should install them by placing the font
      files in the <filename>fonts</filename> folder of your personal
      GIMP directory, or some other location in your font search
      path. The support Windows has varies by version.  All that 
      GIMP runs on support at least TrueType, Windows FON, and Windows
      FNT.  Windows 2000 and later support Type 1 and OpenType.
      Windows ME supports OpenType and possibly Type 1 (but the most
      widely used Windows GIMP installer does not officially support
      Windows ME, although it may work anyway). 
    </para>
    <para lang="zh_CN">
      原则上，GIMP 在 Windows 中可以使用任何 FreeType 能处理的字体;不过对于那些 Windows 内部无法处理的字体，应当将它们放到个人 GIMP 目录的 <filename>fonts</filename> 子目录或字体搜索路径中其它位置。对 Windows 的支持有其版本决定，不过 GIMP 至少能支持 TrueType，Windows FON 和 Windows FNT。Windows 2000 及更高版本支持 Type 1 和 OpenType。Windows ME 支持 OpenType 也许还有 Type 1(不过最广泛使用的 Windows GIMP 安装程序并不正式支持 Windows ME，虽然它能够运行)。
    </para>

    <note lang='en'>
      <para>
	GIMP uses Fontconfig to manage fonts on Windows as well as Linux.
	The instructions above work because Fontconfig by default uses the
	Windows fonts directory, i. e., the same fonts that Windows uses
	itself.  If for some reason your Fontconfig is set up differently,
	you will have to figure out where to put fonts so that GIMP can
	find them:  in any case, the <filename>fonts</filename> folder of
	your personal GIMP directory should work.
      </para>
    </note>
    <note lang="zh_CN">
      <para>
        GIMP 在 Windows 中和 Linux 一样使用 Fontconfig 管理字体。上面的方法可以实现是因为 Fontconfig 默认使用 Windows 的字体文件夹，即和 Windows 自身使用的字体一样。假如您的 Fontconfig 设置地不同，就需要自己知道在什么地方放置 GIMP 能找到的字体：无论如何，个人 GIMP 目录的 <filename>fonts</filename> 文件夹都应当可以工作。
      </para>
    </note>
  </simplesect>

  <simplesect>
    <title lang='en'>Font Problems</title>
    <title lang="zh_CN">字体问题</title>

    <para lang='en'>
      Problems with fonts have probably been responsible for more GIMP
      2 bug reports than any other single cause, although they have
      become much less frequent in the most recent releases in the 2.0
      series.  In most cases they have been caused by malformed font
      files giving trouble to Fontconfig.  If you experience crashes
      at startup when GIMP scans your font directories, the best
      solution is to upgrade to a version of Fontconfig newer than
      2.2.0.  As a quick workaround you can start gimp with the
      <filename>--no-fonts</filename> command-line option, but then
      you will not be able to use the text tool.
    </para>
    <para lang="zh_CN">
      虽然字体问题在 2.0 系列最近的发行版本中越来越少，不过它们可能还是 GIMP 2 bug 报告中被反映地最多的。大多数情况都是由于畸形的字体文件给 Fontconfig 带来问题。当 GIMP 启动时扫描字体目录过程中崩溃了，最好的解决方法就是升级 Fontconfig 版本到 2.2.0 以上。作为应急可以用 <filenmae>--no-fonts</filenmae> 命令行选项启动 GIMP，不过无法使用文字工具。
    </para>

    <para lang='en'>
      Another known problem is that Pango 1.2 cannot load fonts that
      don't provide an Unicode character mapping. (Pango is the text
      layout library used by GIMP.)  A lot of symbol fonts fall into
      this category. On some systems, using such a font 
      can cause GIMP to crash. Updating to Pango 1.4 will fix this
      problem and makes symbol fonts available in GIMP. 
    </para>
    <para lang="zh_CN">
      另一个已知的问题就是 Pango 1.2 无法加载没有 Unicode 字体映射的字体。(GIMP 使用 Pango 作为文字布局库。)许多符号字体属于这一类，使用这些字体在某些系统中会导致 GIMP 崩溃。升级 Pango 到 1.4 就修复了这些问题使符号字体在 GIMP 中可用。
    </para>

    <para lang='en'>
      A frequent source of confusion occurs on Windows systems, when
      GIMP encounters a malformed font file and generates an error
      message:  this causes a console window to pop up so that you can
      see the message.  <emphasis>Do not close that console window.
      It is harmless, and closing it will shut down GIMP.</emphasis>
      When this happens, it often seems to users that GIMP has
      crashed.  It hasn't: closing the console window causes Windows
      to shut GIMP down.  Unfortunately, this annoying situation is
      caused by an interaction between Windows and the libraries
      that GIMP links to:  it cannot be fixed within GIMP.  All you
      need to do, though, if this happens, is minimize the console
      window and ignore it.
    </para>
    <para lang="zh_CN">
      最常见的困惑发生在 Windows 系统中，当 GIMP 碰到畸形字体文件并出现错误消息时：会弹出一个终端窗口显示该消息。<emphasis>不要关闭终端窗口，它们是没有坏处的，关闭它将导致 GIMP 关闭。</emphasis>用户常常认为出现这种情况表明 GIMP 崩溃了，实际上它没有：是由于关闭终端窗口导致 Windows 关闭 GIMP。遗憾的是，这种让人恼火的情况是由于 Windows 和 GIMP 链结库之间的交互引起的，当这种情况发生时，最小化终端窗口并忽略它就行了。
    </para>
  </simplesect>
</sect2>
