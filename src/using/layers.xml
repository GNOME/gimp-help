<?xml version='1.0' encoding="UTF-8" ?>

<sect2 id='gimp-layers' xmlns:xi="http://www.w3.org/2001/XInclude">
  <title lang="en">Layers</title>
  <title lang="zh_CN">图层</title>
  <indexterm>
    <primary lang="en">Image</primary>
    <primary lang="zh_CN">图像</primary>
    <secondary lang="en">Layers</secondary>
    <secondary lang="zh_CN">图层</secondary>
  </indexterm>

  <para lang='en'>
    A good way to visualize a Gimp image is as a stack of
    transparencies:  in Gimp terminology, each individual transparency
    is called a <emphasis>layer</emphasis>.  There is no limit, in
    principle, to the number of layers an image can have:  only
    the amount of memory available on the system.  It is not
    uncommon for advanced users to work with images containing dozens
    of layers.
  </para>
  <para lang="zh_CN">
    形象化一个 Gimp 图像的一个好方法就是把它看作是一堆幻灯片：用 Gimp 的术语说，每个独立的幻灯片被叫作一个<emphasis>图层</emphasis>。一个图像的图层数量大体上没有限制：只要考虑系统可用的内存数。对高级用户而言，处理一个有十多个图层的图像并不常见。
  </para>

  <para lang='en'>
    The organization of layers in an image is shown by the Layers
    dialog, which is the second most important type of dialog window
    in Gimp, after the Main Toolbox.  The appearance of the Layers
    dialog is shown in the adjoining illustration.  How it works is
    described in detail in the <link
    linkend='gimp-layer-dialog'>Layers Dialog</link> section, but we
    will touch on some aspects of it here, in relation to the layer
    properties that they display.
  </para>
  <para lang="zh_CN">
    图层对话框显示一个图像中图层的组织情况，它是 Gimp 中排在主工具箱后第二重要的对话框。图层对话框显示为图层相互毗邻的图表方式。有关它如何工作的细节请看<link linkend='gimp-layer-dialog'>图层对话框</link>章节。不过我们在这里也要讲下有关它所显示的图层属性方面的知识。
  </para>

  <para lang='en'>
    Each open image has at any time a single <emphasis>active
    drawable</emphasis>.  A "drawable" is a Gimp concept that includes
    layers, but also several other types of things, such as channels,
    layer masks, and the selection mask.  (Basically, a "drawable" is
    anything that can be drawn on with painting tools.)  If a layer is
    currently active, it is shown highlighted in the Layers dialog,
    and its name is shown in the status area of the image window.
    If not, you can activate it by clicking on it.  If none of the
    layers is highlighted, it means the active drawable is something
    other than a layer.      
  </para>
  <para lang="zh_CN">
    每个打开的图像在任何时候都是一个单独的<emphasis>活动可绘</emphasis>。一个“可绘”是 Gimp 概念，它包括图层，不过还有许多其它类型的东西，如通道，图层蒙板和选区蒙板。(大致上，一个“可绘”就是指能进行涂画工具操作的任何东西。)如果一个图层当前活动，它就在图层对话框中高亮，并在图像窗口的状态区显示其名字。否则，您可以点击它来激活它。如果没有一个图层是高亮的，就意味着活动可绘是另外的东西，而不是一个图层。
  </para>

  <para lang='en'>
    In the menubar above an image window, you can find a menu called
    <guimenu>Layer</guimenu>, containing a number of commands that
    affect the active layer of the image.  The same menu can be
    accessed by right-clicking in the Layers dialog.
  </para>
  <para lang="zh_CN">
    在图像窗口上的菜单条，您能发现一个包含一系列影响图像当前图层命令的菜单，叫<guimenu>图层</guimenu>。右键点击图层对话框也能得到同样的菜单。
  </para>

  <para lang='en'>
    Each layer in an image has a number of important attributes:
  </para>
  <para lang="zh_CN">
    每个图像的图层都有一些重要的属性：
  </para>

  <variablelist>
  
    <varlistentry>
    <term lang='en'>Name</term>
    <term lang="zh_CN">名字</term>
    <listitem>
      <para lang='en'>
        Every layer has a name.  This is assigned automatically when
        the layer is created, but you can change it.  You can change
        the name of a layer either by double-clicking on it in the
        Layers dialog, or by right-clicking there and then selecting
        the top entry in the menu that appears, <guimenuitem>Edit
        Layer Attributes</guimenuitem>.
      </para>
      <para lang="zh_CN">
        每个图层都有一个名字，它是在图层创建时自动获取的，不过您也能改变它。可以通过在图层对话框中双击它，或右键点击它然后选取弹出菜单最上面的项目，<guimenuitem>编辑图层属性</guimenuitem>。
      </para>
    </listitem>
    </varlistentry>

    <varlistentry>
    <term lang='en'>Presence or absence of an alpha channel</term>
    <term lang="zh_CN">存在或不存在一个 alpha 通道</term>
    <listitem>
      <para lang='en'>
        As explained in the previous section, an alpha channel encodes
        information about how transparent a layer is at each pixel.
        Not every layer is required to have an alpha channel, though.
        In many cases, the bottom layer of an image (often named
        "Background") lacks any alpha channel:  this means that it is
        completely opaque at every point.  Alphaless layers are
        created when you open an image from a file format that does
        not support transparency, or when you create a new image using 
        <menuchoice>
          <guimenu>File</guimenu>
          <guimenuitem>New</guimenuitem>
        </menuchoice>, or when you flatten an image into a single
        layer. 
      </para>
      <para lang="zh_CN">
        正如前面章节所讲述的，一个 alpha 通道保存一个图层在每个像素处的透明程度信息，虽然并不是每个图层都需要一个 alpha 通道。在大部分情况下，图像的最底层图层(通常叫作“背景”)缺乏任何 alpha 通道：这就意味着其每个点都是不透明的。没有 alpha 通道的图层在读取一个不支持透明的图像时，或使用
者      <menuchoice>
          <guimenu>文件</guimenu>
          <guimenuitem>新建</guimenuitem>
        </menuchoice>来创建新图像时，或平整一个图像到单一图层时出现。
      </para>
      <para lang='en'>
        Every layer other than the bottom layer of an image must have an
        alpha channel. For the bottom layer, it is optional.  Many
        operations cannot be performed on layers that lack an alpha
        channel.  Moving the layer to a different position in the
        layer stack is one obvious example (since only bottom layers
        are allowed not to have an alpha channel), but any operation
        involving transparency would also be included.   You can add
        an alpha channel to a layer that lacks one using the menu
        command 
        <menuchoice>
          <guimenu>Layer</guimenu>
          <guisubmenu>Transparency</guisubmenu>
          <guimenuitem>Add Alpha Channel</guimenuitem>
        </menuchoice>, or by right-clicking in the Layers dialog and
          selecting <guimenuitem>Add Alpha Channel</guimenuitem> from
          the popup menu that appears.  To remove an alpha channel,
          activate the bottom layer by clicking on it in the Layers
          dialog, and then select
        <menuchoice>
          <guimenu>Layer</guimenu>
          <guisubmenu>Transparency</guisubmenu>
          <guimenuitem>Semi-Flatten</guimenuitem>
        </menuchoice>.
       </para>
       <para lang="zh_CN">
         除了最底下的图层，每个图像中的图层都必须要有一个 alpha 通道。而对最底下图层，而就是可选的。许多操作对没有一个 alpha 通道的图层无法进行。在图层堆栈中移动图层到别的位置就是一个明显的例子(只有最底下图层允许没有一个 alpha 通道)，不过也包括任何有关透明度的操作。您能通过
         <menuchoice>
          <guimenu>图层</guimenu>
          <guisubmenu>透明</guisubmenu>
          <guimenuitem>添加 Alpha 通道</guimenuitem>
         </menuchoice> 来为缺乏一个 alpha 通道的图层来添加，或在图层对话框中点右键并在弹出菜单中选取<guimenuitem>添加 Alpha 通道</guimenuitem>。要删除一个 alpha 通道，在图层对话框中点击最底下图层，并选取
          <menuchoice>
          <guimenu>图层</guimenu>
          <guisubmenu>透明</guisubmenu>
          <guimenuitem>半平整</guimenuitem>
        </menuchoice> 。
       </para>
     </listitem>
    </varlistentry>

    <varlistentry>
    <term lang='en'>Layer type</term>
    <term lang="zh_CN">图层类型</term>
    <listitem>
      <para lang='en'>
        The layer type is determined by the image type (see previous
        section) and the presence or absence of an alpha channel.
        These are the possible layer types:
      </para>
      <para lang="zh_CN">
        图层类型由图像类型(看前一节)和是否存在一个 alpha 通道决定。这有三种可能的类型：
      </para>
      <itemizedlist>
        <listitem>
          <para lang='en'>
            RGB
          </para>
          <para lang="zh_CN">
            RGB
          </para>
        </listitem>
        <listitem>
          <para lang='en'>
            RGBA
          </para>
          <para lang="zh_CN">
            RGBA
          </para>
        </listitem>
        <listitem>
          <para lang='en'>
            Gray
          </para>
          <para lang="zh_CN">
            灰度
          </para>
        </listitem>
        <listitem>
          <para lang='en'>
            GrayA
          </para>
          <para lang="zh_CN">
            灰度A
          </para>
        </listitem>
        <listitem>
          <para lang='en'>
            Indexed
          </para>
          <para lang="zh_CN">
            索引
          </para>
        </listitem>
        <listitem>
          <para lang='en'>
            IndexedA
          </para>
          <para lang="zh_CN">
            索引A
          </para>
        </listitem>
      </itemizedlist>
      <para lang='en'>
        The main reason this matters is that most filters (in the
        <guimenu>Filters</guimenu> menu) only accept a subset of layer
        types, and appear grayed out in the menu if the active layer
        does not have an acceptable type.  Often you can rectify this
        either by changing the mode of the image or by adding or
        removing an alpha channel.
      </para>
      <para lang="zh_CN">
        讲这些的主要原因是，大部分滤镜(在<guimenu>滤镜</guimenu>菜单中)只接受一定的图层类型，如果活动图层没有一个可以接受的类型，这些滤镜在菜单中就呈灰色而不可用。通常您可以通过改变图像模式或添加或删除一个 alpha 通道来纠正。
      </para>
    </listitem>
    </varlistentry>

    <varlistentry>
    <term lang='en'>Visibility</term>
    <term lang="zh_CN">可见性</term>
    <listitem>
      <para lang='en'>
        It is possible to temporarily remove a layer from an image,
        without destroying it, by clicking on the "open eye" symbol in
        the Layers dialog.  This is called "toggling the visibility"
        of the layer.  Most operations on an image treat toggled-off
        layers as if they did not exist.  When you work with images
        containing many layers, with varying opacity, you often can
        get a better picture of the contents of the layer you want to
        work on by hiding some of the other layers.  
      </para>
      <para lang="zh_CN">
        可以通过点击图层对话框的“眼睛”标志来暂时地从一个图像中删除一个图层，而不用破坏它。这被叫作“切换图层可见性”。大部分在图像上的操作把切换不可见的图层认为不存在。但您处理多图层不同透明度的图像时，常常可以通过隐藏其它一些图层来使您对所处理的图层更好得操作。
      </para>
      <note lang='en'>
        If you <emphasis>Shift</emphasis>-click on the eye symbol,
        this will cause all layers <emphasis>except</emphasis> the one
        you click on to be hidden.
      </note>
      <note lang="zh_CN">
        当您 <emphasis>Shift</emphasis>-左键点击眼睛标志，<emphasis>除了</emphasis>您点击所有的，所有图层将被隐藏。
     </note>
    </listitem>
    </varlistentry>

    <varlistentry>
    <term lang='en'>Linkage to other layers</term>
    <term lang="zh_CN">和其它图层联动</term>
    <listitem>
      <para lang='en'>
        
      </para>
    </listitem>
    </varlistentry>

    <varlistentry>
    <term lang='en'>Dimensions</term>
    <term lang="zh_CN">尺寸</term>
    <listitem>
      <para lang='en'>
        In Gimp, the boundaries of a layer do not necessarily match
        the bondaries of the image that contains it.  When you create
        text, for example, each text item goes into its own separate
        layer, and the layer is precisely sized to contain the text
        and nothing more.  Also, when you create a new layer using
        cut-and-paste, the new layer is sized just large enough to
        contain the pasted item.  In the image window, the boundaries
        of the currently active layer are shown outlined with a
        black-and-yellow dashed line.
      </para>
      <para lang="zh_CN">
        Gimp 中，一个图层的边界没有必要和包含它的图像的边界吻合。比如，当您创建文本时，每个文本在其单独的图层中，该图层刚好容纳下这些文字。同样，当您用剪切-粘贴创建新图层时，它也大小合适刚好容纳下被粘贴的内容。在图像窗口中，当前活动图层的边界由一圈黄黑色虚线包围。
      </para>
      <para lang='en'>
        The main reason why this matters is that you cannot do
        anything to a layer outside of its boundaries:  you can't act
        on what doesn't exist.  If this causes you problems, you can
        alter the dimensions of the layer using any of several
        commands that you can find near the bottom of the
        <guimenu>Layer</guimenu> menu.
      </para>
      <para lang="zh_CN">
        讲这些的主要原因是您无法在一个图层边界外干任何事：您无法在不存在的部分操作。如果这给您带来麻烦，您能够使用任何在<guimenu>图层</guimenu>菜单下部的许多命令来调整图层的尺寸。
      </para>
      <note lang='en'>
        The amount of memory that a layer consumes is determined by
        its dimensions, not its contents.  So, if you are working with
        large images or images that contain many layers, it might pay
        off to trim layers to the minimum possible size.
      </note>
      <note lang="zh_CN">
        一个图层消耗的内存数量由它的尺寸而不是其内存决定。因此，当您处理大图像或包括许多图层的图像时，裁剪图层到尽可能小的尺寸是有效的。
      </note>
    </listitem>
    </varlistentry>

    <varlistentry>
    <term lang='en'>Opacity</term>
    <term lang="zh_CN">不透明度</term>
    <listitem>
      <para lang='en'>
        The oacity of a layer determines the extent to which it lets
        colors from layers beneath it in the stack show through.
        Opacity ranges from 0 to 100, with 0 meaning complete
        transparency, and 100 meaning complete opacity.  
      </para>
      <para lang="zh_CN">
        不透明度决定堆栈中显示在其下的图层颜色的允许扩展范围。不透明度从 0 到 100，0 表示完全透明，而 100 表示完全不透明。
     </para>
    </listitem>
    </varlistentry>

    <varlistentry>
    <term lang='en'>Mode</term>
    <term lang="zh_CN">模式</term>
    <listitem>
      <para lang='en'>
        The Mode of a layer determines how colors from the layer are
        combined with colors from the underlying layers to produce a
        visible result.  This is a sufficiently complex, and
        sufficiently important, concept to deserve a section of its
        own, which follows.
      </para>
      <para lang="zh_CN">
        一个图层的模式决定图层和其下面的图层是如何组合来产生一个可见的结果的。这是一个最够复杂和重要的概念，下面一节讲专门介绍。
     </para>
    </listitem>
    </varlistentry>

    <varlistentry>
    <term lang='en'>Layer mask</term>
    <term lang="zh_CN">图层蒙板</term>
    <listitem>
      <para lang='en'>
        In addition to the alpha channel, there is another way to
        control the transparency of a layer:  by adding a
        <emphasis>layer mask</emphasis>, which is an extra grayscale
        drawable associated with the layer.  A layer does not have a
        layer mask by default:  it must be added specifically.  Layer
        masks, and how to work with them, are described much more
        extensively in a later  section of this chapter devoted to
        them. 
      </para>
      <para lang="zh_CN">
        除了 alpha 通道，还有另一个方法来控制图层的透明：通过添加一个<emphasis>图层蒙板</emphasis>，它是一个与该图层有联系的多余的灰度可绘。它必须被特别地添加。有关图层蒙板及其如何工作，在后续章节有关于它的专门介绍。
      </para>
    </listitem>
    </varlistentry>

    <varlistentry>
    <term lang='en'>"Keep transparency" setting</term>
    <term lang="zh_CN">“保持透明部分”设置</term>
    <listitem>
      <para lang='en'>
        In the upper right corner of the Layers dialog appears a small
        checkbox that controls the "keep transparency" setting for the
        layer.  If this is checked, then the alpha channel for the
        layer is locked,
        and no manipulation has any effect on it.  In particular,
        nothing that you do to a transparent part of the layer will
        have any effect.
      </para>
      <para lang="zh_CN">
        在图层对话框右上角有个控制图层“保持透明部分”设置的勾选框。如果勾选，图层的 alpha 通道就被锁住，任何操作都对它无效。特别的，任何对图层透明部分的操作的没有效果。
      </para>
    </listitem>
    </varlistentry>

  </variablelist>

  <simplesect>
    <title lang='en'>Creating New Layers</title>
    <title lang="zh_CN">创建新图层</title>
    
    <para lang='en'>
      There are several ways to create new layers in an image.  Here
      are the most important ones:
    </para>
    <para lang="zh_CN">
      在一个图像中创建图层有多种方式。下面是最重要的一种：
    </para>

    <itemizedlist>

      <listitem>
        <para lang='en'>
          Selecting
          <menuchoice>
            <guimenu>Layer</guimenu>
            <guimenuitem>New Layer</guimenuitem>
          </menuchoice>
          in the image menu.  This brings up a dialog that allows you
          to set the basic properties of the new layer; see the <link
          linkend='gimp-new-layer-dialog'>New Layer dialog</link>
          section for help with it.
        </para>
        <para lang="zh_CN">
          选取在图像菜单中的
          <menuchoice>
            <guimenu>图层</guimenu>
            <guimenuitem>新建图层</guimenuitem>
          </menuchoice>
            ，将弹出一个允许您设置新图层基本属性的对话框；请看<link linkend='gimp-new-layer-dialog'>新建图层对话框</link>来获得帮助。
         </para>
       </listitem>

      <listitem>
        <para lang='en'>
          Selecting
          <menuchoice>
            <guimenu>Layer</guimenu>
            <guimenuitem>Duplicate Layer</guimenuitem>
          </menuchoice>
          in the image menu.  This creates a new layer, at the top of
          the layer stack, that is a perfect copy of the currently
          active layer.
        </para>
        <para lang="zh_CN">
          选取在图像菜单中的
          <menuchoice>
            <guimenu>图层</guimenu>
            <guimenuitem>复制图层</guimenuitem>
          </menuchoice>
          。这将在图层堆栈最顶端创建一个新图层，它是当前活动图层的完整拷贝。
        </para>
      </listitem>

      <listitem>
        <para lang='en'>
          When you "cut" something, and then paste it using Ctrl-V or 
          <menuchoice>
            <guimenu>Edit</guimenu>
            <guimenuitem>Paste</guimenuitem>
          </menuchoice>, the result is a
            "floating selection", which is a sort of temporary layer.
            Before you can do anything else, you either have to anchor
            the floating selection to an existing layer, or convert it
            into a normal layer.  If you do the latter, the new layer
            will be sized just large enough to contain the pasted
            material. 
        </para>
        <para lang="zh_CN">
          当您“剪切”一些东西，其后可以通过 Ctrl-V 或
          <menuchoice>
            <guimenu>编辑</guimenu>
            <guimenuitem>粘贴</guimenuitem>
          </menuchoice>，它将产生一个“浮动选取”，就是一种临时图层。您需要固定它到现有图层，或转换浮动选取为一个普通图层后才能处理它。如果您做了后者，新图层的尺寸控制在刚刚能容纳粘贴内容的大小。
        </para>
      </listitem>

    </itemizedlist>

  </simplesect>

</sect2>
