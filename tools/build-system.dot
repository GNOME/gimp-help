/*
    Proposed gettext-based gimp-help build system

    Shapes:
        - circle    main targets
        - ellipse   lang-dependent or auxiliary targets
        - box       file or directory targets
        - polygon   file list
        - hexagon   TODO etc.
    Colors:
        - blue      PO & POT
        - green     XML
        - yellow    HTML
        - grey      minor targets etc.
        - red       TODO
*/

digraph gimp_build_system {
    node[shape=box];

    all[label="all" color=blue shape="circle"];

    all -> validate[label="?"];
    all -> html;
    all -> index[label="?" color=grey];
    all -> authors;

    /* do_nothing[label="do nothing" color=grey shape=hexagon] */
    /* todo[label="TODO" color=red shape=hexagon] */

    node[shape=circle];
    pot[label="pot"];
    po[shape=circle];

    po -> po_lang[label="TODO" color=red];
    pot -> pot_files;

    subgraph cluster_po {
        color="blue";
    
        src_files[label="SRC FILES\n----\nsrc/*.xml" color=cyan shape=polygon side=4 skew=.5];
        pot_files[label="POT FILES\n----\npot/LANG/*.pot" color=cyan shape=polygon side=4 skew=.5];
        po_files[label="PO FILES\n----\npo/LANG/*.po" color=cyan shape=polygon side=4 skew=.5];
    
        pot_files -> src_files;
        
        node[shape=ellipse];
        po_lang[label="po-LANG" color=grey shape=ellipse];
        po_lang -> po_files -> pot_files;
        /* po_en[label="po-en" color=grey] */
        /* po_en -> do_nothing */
    
    } /* subgraph cluster_po */

    subgraph cluster_authors {
        color="grey";

        authors[label="AUTHORS" color=grey shape=box]
        authors_xml[label="stylesheets/\nauthors.xml" color=grey shape=box]
        authors -> authors_xml[color=grey]
    } /* subgraph cluster_authors */


    xml[label="xml" shape=circle];

    subgraph cluster_xml {
        color="green";
    
        xml_files[label="xml/LANG/*.xml" shape=box];
        xml_dir[label="xml/LANG" shape=box]
        xml_lang[label="xml-LANG" color=grey shape=ellipse]
        /* xml_en[label="xml-en" color=green shape=ellipse] */
    
        xml_dir -> xml_files -> po_files
        xml_lang -> xml_files
        /* xml_en -> src_files[label="link" color="grey"] */

    } /* subgraph cluster_xml */

    html[color=blue shape=circle]
    index[color=grey shape=ellipse]
    index -> index_lang[color=grey label="?"]

    subgraph cluster_html {
        color="yellow";
    
        html_lang[label="html-LANG" color=grey shape=ellipse]
        html_main[label="html/LANG/index.html" shape=box]
        index_lang[label="index-LANG" color=grey shape=ellipse]
        xrefs_lang[label="html/LANG/gimp-xrefs.html" shape=box] 
        help_lang[label="html/LANG/gimp-help.xml" shape=box]
    
        
        /* html_lang -> po_lang */
        html_lang -> index_lang
        html_lang -> html_main[style=dashed color=grey label=" ?"]
        html_main -> xml_dir[label=" stamp"]
        xrefs_lang -> html_main
    
        index_lang -> help_lang -> xrefs_lang

    } /* subgraph cluster_html */


    /* TODO */

    xml[shape=circle]
    checks[color=blue shape=ellipse]
    check1[label="check [...]" color=grey shape=ellipse]
    validate[color=grey shape=ellipse]
    xmllint[color=grey shape=ellipse]

    xml ->  xml_lang[label="TODO" color=red]
    /* xml ->  xml_en[color=grey] */
    xml ->  po[style=dashed color=grey label=" ?"]
    html -> html_lang[label="TODO" color=red]
    checks -> validate[color=grey style=dashed label=" ?"]
    checks -> check1[color=grey label=" TODO"]
    validate -> xmllint[color=red style=dashed label=" TODO"]

} /* digraph gimp_build_system */
