/*
    Proposed gettext-based gimp-help build system

    Shapes:
        - circle    main targets
        - ellipse   lang-dependent or auxiliary targets
        - box       file or directory targets
        - hexagon   TODO etc.
    Colors:
        - blue      default, language-independent
        - green     language-dependent
        - red       TODO
        - grey      TODO, ignore, etc.
*/
digraph gimp {
    node[shape=box];

    all[label="all" color=blue shape="circle"]

    all -> validate[label="?"];
    all -> html;
    all -> index[label="?" color=grey];
    all -> authors;

    /* do_nothing[label="do nothing" color=grey shape=hexagon] */
    todo[label="TODO" color=red shape=hexagon]

    /* $(POT_FILES): $(potdir)/%.pot : $(xmldir)/%.xml */

    src_files[label="src/*.xml" color=blue ]
    pot_files[label="pot/*.pot" color=blue]
    po_files[label="po/LANG/*.po" color=green]
    node[shape=ellipse];
    xml[label="xml" color=blue]
    pot[label="pot" color=blue]

    pot -> pot_files -> src_files
    
    /* XX_PO_FILES = $(patsubst $(potdir)/%.pot, $(podir)/XX/%.po, $(POT_FILES)) */

    po[color=green shape=ellipse]
    po_lang[label="po-LANG" color=green]
    po -> po_lang[label="TODO" color=red]
    po_lang -> po_files -> pot_files
    /* po_en[label="po-en" color=grey] */
    /* po_en -> do_nothing */

    /* XX_XML_FILES = $(XML_FILES:$(xmldir)/%=$(xmlpodir)/$(1)/%)
       $(XX_XML_FILES): $(xmlpodir)/XX/%.xml : $(podir)/XX/%.po */

    xml[label="xml" color=blue shape=circle]
    xml_files[label="xml/LANG/*.xml" color=green shape=box]
    xml_dir[label="xml/LANG" color=green shape=box]
    xml_dir_en[label="xml/en" color=green shape=box]
    xml_lang[label="xml-LANG" color=green]
    xml_en[label="xml-en" color=green shape=ellipse]

    xml_dir -> xml_files -> po_files
    xml_lang -> xml_files
    xml_en -> xml_dir_en
    xml_dir_en -> xml_files[label="link" color="grey"]

    /* html-%: po-% index-% html/%/index.html */
    /* html/%/index.html: $(xmlpodir)/% $(HTML_STYLESHEETS) */

    /* html/%/gimp-xrefs.xml: html/%/index.html */

    html_lang[label="html-LANG" color=green shape=ellipse]
    html_main[label="html/LANG/index.html" color=green shape=box]
    index_lang[label="index-LANG" color=green shape=ellipse]
    xrefs_lang[label="html/LANG/gimp-xrefs.html" shape="box" color="green"] 
    
    html_lang -> po_lang
    html_lang -> index_lang
    html_lang -> html_main -> xml_dir
    xrefs_lang -> html_main

    /* index: $(foreach lang,$(LANGUAGES),index-$(lang)) */
    /* index-%: html/%/gimp-help.xml */

    /* html/%/gimp-help.xml: html/%/gimp-xrefs.xml stylesheets/makeindex.xsl */

    index[color=grey shape=ellipse]
    index_lang[label="index-LANG" color=green shape=ellipse]
    help_lang[label="html/LANG/gimp-help.xml" color=green shape=box]

    index -> index_lang[color=grey label="?"]
    index_lang -> help_lang -> xrefs_lang

    /* TODO */

    html[shape=circle]
    xml[shape=circle]
    check[color=blue shape=ellipse]
    validate[color=blue shape=ellipse]
    authors[label="AUTHORS" color=blue shape=box]

    xml ->  xml_lang[label="TODO" color=red]
    xml ->  xml_en[color=grey]
    xml ->  po[color=grey label="TODO?"]
    html -> html_lang[label="TODO" color=red]
    authors -> todo
    check -> validate -> todo
}

